\documentclass[letterpaper]{article} 
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{array}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage[version=4]{mhchem}
\usepackage{stmaryrd}
\usepackage[dvipsnames]{xcolor}
\colorlet{LightRubineRed}{RubineRed!70}
\colorlet{Mycolor1}{green!10!orange}
\definecolor{Mycolor2}{HTML}{00F9DE}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{capt-of}
\usepackage{lipsum}
\usepackage{fancyvrb}
\usepackage{tabularx}
\usepackage{listings}
\usepackage[export]{adjustbox}
\graphicspath{ {./images/} }
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{float}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{float}
\usepackage[margin=0.7in]{geometry}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{capt-of}
\usepackage{tcolorbox}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{float}
\usepackage{listings}
\usepackage{hyperref} 
\usepackage{xcolor} % For custom colors
\lstset{
	language=Python,                % Choose the language (e.g., Python, C, R)
	basicstyle=\ttfamily\small, % Font size and type
	keywordstyle=\color{blue},  % Keywords color
	commentstyle=\color{gray},  % Comments color
	stringstyle=\color{red},    % String color
	numbers=left,               % Line numbers
	numberstyle=\tiny\color{gray}, % Line number style
	stepnumber=1,               % Numbering step
	breaklines=true,            % Auto line break
	backgroundcolor=\color{black!5}, % Light gray background
	frame=single,               % Frame around the code
}
\usepackage{float}
\usepackage[]{amsthm} %lets us use \begin{proof}
	\usepackage[]{amssymb} %gives us the character \varnothing
	
	\title{Homework 1, MATH 5265}
	\author{Zongyi Liu}
	\date{Wed, Sept 24, 2025}
	\begin{document}
		\maketitle
		
		\section{Question 1 }
		
		Consider the simple stock market:
		
		$$
		\begin{cases}d S_{t}=\mu(t) S_{t} d t+\sigma(t) S_{t} d W_{t}, & S_{0}=s_{0} \\ d B_{t}=r(t) B_{t} d t, & B_{0}=1\end{cases}
		$$
		
		where $W=\left(W_{t}\right)_{t \geq 0}$ is a $\mathbb{P}$-Brownian motion and $\mu(\cdot), r(\cdot), \sigma(\cdot)$ are deterministic functions of time. Suppose you want to price a European contract with payoff $F\left(S_{T}\right)$ at some time $T>0$. By assuming enough differentiability and the law of one price, employ a dynamic hedging argument to derive the PDE that the price should satisfy.
		
		\textbf{Answer}
		
		
		Let $V(t, S_t)$ be the price of the European contract at time $t$. The dynamic hedging argument requires constructing a self-financing portfolio $\Pi_t$ that perfectly replicates the option's payoff.
		
		
		The replicating portfolio $\Pi_t$ is composed of $\phi_t$ shares of the stock $S_t$ and an amount $\psi_t$ invested in the bond $B_t$:
		$$
		\Pi_t = V(t, S_t) = \phi_t S_t + \psi_t B_t
		$$
		The differential of the portfolio value, under the self-financing condition, is:
		$$
		d\Pi_t = \phi_t dS_t + \psi_t dB_t
		$$
		
		
		Assuming $V(t, S)$ is a smooth function, It√¥'s Lemma gives the differential of the option price:
		$$
		dV(t, S_t) = \left( \frac{\partial V}{\partial t} + \mu(t) S_t \frac{\partial V}{\partial S} + \frac{1}{2} \sigma(t)^2 S_t^2 \frac{\partial^2 V}{\partial S^2} \right) dt + \sigma(t) S_t \frac{\partial V}{\partial S} dW_t
		$$
		
		
		Substitute the SDEs for $dS_t$ and $dB_t$ into $d\Pi_t$:
		$$
		\begin{aligned}
			d\Pi_t &= \phi_t \left( \mu(t) S_t d t + \sigma(t) S_t d W_{t} \right) + \psi_t \left( r(t) B_{t} d t \right) \\
			&= \left( \phi_t \mu(t) S_t + \psi_t r(t) B_t \right) dt + \left( \phi_t \sigma(t) S_t \right) dW_t
		\end{aligned}
		$$
		From the portfolio value equation, we have $\psi_t B_t = V - \phi_t S_t$. Substituting this into the $dt$ term:
		$$
		\begin{aligned}
			d\Pi_t &= \left( \phi_t \mu(t) S_t + r(t) (V - \phi_t S_t) \right) dt + \left( \phi_t \sigma(t) S_t \right) dW_t \\
			&= \left( r(t) V + \phi_t S_t (\mu(t) - r(t)) \right) dt + \left( \phi_t \sigma(t) S_t \right) dW_t
		\end{aligned}
		$$
	
		
		By the law of one price, $d\Pi_t = dV(t, S_t)$. Equating the $dW_t$ terms (Stochastic part):
		$$
		\sigma(t) S_t \frac{\partial V}{\partial S} = \phi_t \sigma(t) S_t
		$$
		This gives the Delta hedge ratio:
		$$
		\phi_t = \frac{\partial V}{\partial S}
		$$
		Equating the $dt$ terms (Deterministic part) and substituting the expression for $\phi_t$:
		$$
		\frac{\partial V}{\partial t} + \mu(t) S_t \frac{\partial V}{\partial S} + \frac{1}{2} \sigma(t)^2 S_t^2 \frac{\partial^2 V}{\partial S^2} = r(t) V + \left( \frac{\partial V}{\partial S} \right) S_t (\mu(t) - r(t))
		$$
		Rearranging the terms:
		$$
		\frac{\partial V}{\partial t} + \mu(t) S_t \frac{\partial V}{\partial S} - \mu(t) S_t \frac{\partial V}{\partial S} + r(t) S_t \frac{\partial V}{\partial S} + \frac{1}{2} \sigma(t)^2 S_t^2 \frac{\partial^2 V}{\partial S^2} - r(t) V = 0
		$$
		The terms involving $\mu(t)$ cancel, leaving the PDE:
		$$
		\frac{\partial V}{\partial t} + r(t) S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma(t)^2 S^2 \frac{\partial^2 V}{\partial S^2} - r(t) V = 0
		$$
		
		The price $V(t, S)$ of the European contract must satisfy the following Partial Differential Equation with the terminal condition:
		
		$$
		\begin{cases}
			\frac{\partial V}{\partial t} + r(t) S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma(t)^2 S^2 \frac{\partial^2 V}{\partial S^2} - r(t) V = 0, & \forall (t, S) \in [0, T) \times (0, \infty) \\
			V(T, S) = F(S), & \forall S \in (0, \infty)
		\end{cases}
		$$		
		\clearpage
		\section{Question 2}
		Suppose that you have a 3 asset market whose dynamics under the risk-neutral measure $\mathbb{Q}$ are given by:
		
		$$
		\begin{cases}d S_{t}=r S_{t} d t+\sigma S_{t} d W_{t}^{\mathbb{Q}}, & S_{0}=s_{0} \\ d A_{t}=r A_{t} d t+\eta A_{t} d W_{t}^{\mathbb{Q}}, & A_{0}=a_{0} \\ d B_{t}=r B_{t} d t, & B_{0}=1\end{cases}
		$$
		
		where $W^{\mathbb{Q}}$ is a $\mathbb{Q}$-Brownian motion.
		
		\begin{enumerate}
			\item Repeat the arguments from class to derive the dynamics of the market under $\mathbb{Q}^{S}$ (the EMM induced by $S$ as the numeraire).
			\item Write down the Radon-Nikodym Process that changes the measure from $\mathbb{Q}^{S}$ to $\mathbb{Q}^{A}$ (the EMM induced by $A$ as the numeraire). Verify that the relative (to $A$ ) price processes are martingales under $\mathbb{Q}^{A}$.
			\item Relate the $\mathbb{Q}^{A}$-Brownian motion to the $\mathbb{Q}^{S}$-Brownian motion and write the dynamics of the market under $\mathbb{Q}^{A}$.
		\end{enumerate}
		
		\clearpage
		\section{Question 3}
		
		Consider the following Black-Scholes market:
		
		$$
		\begin{cases}d S_{t}=\mu S_{t} d t+\sigma S_{t} d W_{t}, & S_{0}=s_{0} \\ d B_{t}=r B_{t} d t, & B_{0}=1\end{cases}
		$$
		
		where $W=\left(W_{t}\right)_{t \geq 0}$ is a $\mathbb{P}$-Brownian motion. Use the Fundamental Theorem of Asset Pricing and a clever choice of numeraire(s) to price a European Put (i.e. the option with payoff $F(x)=(K-x)_{+}$). Verify that your solution coincides exactly with the result from class.
		
		\textbf{Answer}
		
		
		The price $P(t, S_t)$ of a European Put option with payoff $F(S_T) = (K - S_T)^+$ is given by the Fundamental Theorem of Asset Pricing (FTAP) as the expected discounted payoff under the unique Equivalent Martingale Measure $\mathbb{Q}$:
		$$
		P(t, S_t) = e^{-r(T-t)} \mathbb{E}^{\mathbb{Q}}[(K - S_T)^+ | \mathcal{F}_t]
		$$
		Let $\tau = T-t$. The expectation is decomposed into two terms:
		$$
		P(t, S_t) = e^{-r\tau} \left( K \cdot \mathbb{Q}(S_T < K) - \mathbb{E}^{\mathbb{Q}}[S_T \cdot \mathbf{1}_{S_T < K}] \right)
		$$
		
		
		Under the risk-neutral measure $\mathbb{Q}$, $S_T$ is log-normally distributed:
		$$
		\ln S_T \sim \mathcal{N}\left( \ln S_t + \left(r - \frac{1}{2}\sigma^2\right)\tau, \sigma^2 \tau \right)
		$$
		The probability $\mathbb{Q}(S_T < K)$ is calculated by standardizing the log-normal variable.
		$$
		\mathbb{Q}(S_T < K) = \mathbb{Q}\left( \frac{\ln S_T - \left(\ln S_t + (r - \frac{1}{2}\sigma^2)\tau\right)}{\sigma \sqrt{\tau}} < \frac{\ln K - \ln S_t - (r - \frac{1}{2}\sigma^2)\tau}{\sigma \sqrt{\tau}} \right)
		$$
		Let $d_2$ be the negative of the upper bound of the standard normal variable $Z \sim \mathcal{N}(0, 1)$:
		$$
		d_2 = \frac{\ln \left(\frac{S_t}{K}\right) + \left(r - \frac{1}{2}\sigma^2\right)\tau}{\sigma \sqrt{\tau}}
		$$
		$$
		\mathbb{Q}(S_T < K) = \Phi\left( -d_2 \right)
		$$
		where $\Phi(\cdot)$ is the cumulative distribution function of the standard normal distribution.
		The first part of the price is:
		$$
		\text{Term 1} = K e^{-r\tau} \Phi(-d_2)
		$$
		
		
		We use the stock price $S_t$ as the numeraire and the corresponding measure $\mathbb{Q}^S$ (the $S$-measure). The relationship between the expectations is given by the Radon-Nikodym derivative $\frac{d\mathbb{Q}^S}{d\mathbb{Q}} \Big|_{\mathcal{F}_T} = \frac{S_T / S_t}{B_T / B_t} = \frac{S_T}{S_t e^{r\tau}}$.
		
		We can rewrite the expectation as:
		$$
		\mathbb{E}^{\mathbb{Q}}[S_T \cdot \mathbf{1}_{S_T < K}] = \mathbb{E}^{\mathbb{Q}}\left[ S_t e^{r\tau} \cdot \mathbf{1}_{S_T < K} \cdot \left( \frac{S_T}{S_t e^{r\tau}} \right) \right]
		$$
		Using the change of measure formula $\mathbb{E}^{\mathbb{Q}}[X \cdot \frac{d\mathbb{Q}^S}{d\mathbb{Q}}] = \mathbb{E}^{\mathbb{Q}^S}[X]$ with $X = \mathbf{1}_{S_T < K}$:
		$$
		\mathbb{E}^{\mathbb{Q}}[S_T \cdot \mathbf{1}_{S_T < K}] = S_t e^{r\tau} \mathbb{E}^{\mathbb{Q}^S}[\mathbf{1}_{S_T < K}] = S_t e^{r\tau} \mathbb{Q}^S(S_T < K)
		$$
		Under $\mathbb{Q}^S$, the drift of the stock price process is $\mu^S = r + \sigma^2$.
		$$
		\ln S_T \sim \mathcal{N}\left( \ln S_t + \left(r + \frac{1}{2}\sigma^2\right)\tau, \sigma^2 \tau \right) \quad \text{under } \mathbb{Q}^S
		$$
		The probability $\mathbb{Q}^S(S_T < K)$ is found by standardizing with the new drift term:
		$$
		\mathbb{Q}^S(S_T < K) = \Phi\left( - \frac{\ln \left(\frac{S_t}{K}\right) + \left(r + \frac{1}{2}\sigma^2\right)\tau}{\sigma \sqrt{\tau}} \right)
		$$
		Let $d_1$ be the positive term:
		$$
		d_1 = \frac{\ln \left(\frac{S_t}{K}\right) + \left(r + \frac{1}{2}\sigma^2\right)\tau}{\sigma \sqrt{\tau}} = d_2 + \sigma \sqrt{\tau}
		$$
		Thus,
		$$
		\mathbb{Q}^S(S_T < K) = \Phi(-d_1)
		$$
		The second part of the price (after discounting) is:
		$$
		\text{Term 2} = e^{-r\tau} \mathbb{E}^{\mathbb{Q}}[S_T \cdot \mathbf{1}_{S_T < K}] = e^{-r\tau} \left( S_t e^{r\tau} \Phi(-d_1) \right) = S_t \Phi(-d_1)
		$$
		
		
		Combining the two terms, $P(t, S_t) = \text{Term 1} - \text{Term 2}$:
		$$
		P(t, S_t) = K e^{-r\tau} \Phi(-d_2) - S_t \Phi(-d_1)
		$$
		where $\tau = T-t$ and $S$ replaces $S_t$:
		$$
		\mathbf{P(t, S) = K e^{-r(T-t)} \Phi(-d_2) - S \Phi(-d_1)}
		$$
		The parameters $d_1$ and $d_2$ are defined as:
		$$
		\begin{aligned}
			d_1 &= \frac{\ln \left(\frac{S}{K}\right) + \left(r + \frac{1}{2}\sigma^2\right)(T-t)}{\sigma \sqrt{T-t}} \\
			d_2 &= d_1 - \sigma \sqrt{T-t}
		\end{aligned}
		$$
		This result is the exact Black-Scholes formula for a European Put option.
		
		\clearpage
		\section{Question 4}
		
		Consider the following Black-Scholes market:
		
		$$
		\begin{cases}d S_{t}=\mu S_{t} d t+\sigma S_{t} d W_{t}, & S_{0}=s_{0} \\ d B_{t}=r B_{t} d t, & B_{0}=1\end{cases}
		$$
		
		where $W=\left(W_{t}\right)_{t \geq 0}$ is a $\mathbb{P}$-Brownian motion. Suppose there is also a public volatility index in the market that is not traded,
		
		$$
		d X_{t}=\kappa\left(\theta-X_{t}\right) d t+\eta d \tilde{W}_{t}, \quad X_{0}=x_{0} \in \mathbb{R}
		$$
		
		defined in terms of another independent $\mathbb{P}$-Brownian motion $\tilde{W}=\left(\tilde{W}_{t}\right)_{t \geq 0}$.
		
		\begin{enumerate}
			\item Is this market complete? Justify your answer.
			\item If $\tilde{W}=W$ does your answer to (1) change? Explain your thinking.
		\end{enumerate}
	
	\textbf{Answer}
	
	\underline{Part 1}

The Black-Scholes market is defined by the traded assets (stock $S_t$ and bond $B_t$):
$$
\begin{cases}
d S_{t}=\mu S_{t} d t+\sigma S_{t} d W_{t} \\
d B_{t}=r B_{t} d t
\end{cases}
$$
The public but non-traded volatility index $X_t$ is:
$$
d X_{t}=\kappa\left(\theta-X_{t}\right) d t+\eta d \tilde{W}_{t}
$$
The primary criterion for market completeness is that the number of independent sources of risk must equal the number of risky traded assets available for dynamic hedging.

\underline{Part 2}

\emph{Case 1: $\tilde{W}$ and $W$ are Independent}

The market is \textbf{incomplete}.

Justification as below:

\begin{enumerate}
\item \textbf{Number of Independent Sources of Risk:} Since $W$ and $\tilde{W}$ are independent $\mathbb{P}$-Brownian motions, there are {two} independent sources of randomness: $dW_t$ and $d\tilde{W}_t$.
\item \textbf{Number of Risky Traded Assets:} There is only \textbf{one} risky traded asset, the stock $S_t$, which is only driven by $dW_t$. The bond $B_t$ is deterministic (risk-free).
\end{enumerate}
Since the number of risk sources (2) is greater than the number of risky traded assets (1), it is \textbf{impossible} to construct a self-financing portfolio of $S_t$ and $B_t$ that can hedge risk stemming from the factor $d\tilde{W}_t$. Any contingent claim whose payoff depends on the realization of $X_T$ (such as an option on the index $X_t$) cannot be perfectly replicated. Therefore, the market is incomplete.

\emph{Case 2: $\tilde{W}=W$}

If $\tilde{W}=W$, the answer to (1) {changes}. The market becomes {complete}.

If $\tilde{W}=W$, the two driving Brownian motions collapse into a single risk factor $dW_t$.
The system is now driven by:
$$
\begin{cases}
d S_{t}=\mu S_{t} d t+\sigma S_{t} d W_{t} \\
d X_{t}=\kappa\left(\theta-X_{t}\right) d t+\eta d W_{t}
\end{cases}
$$
\begin{enumerate}
\item \textbf{Number of Independent Sources of Risk:} There is now only {one} common source of randomness: $dW_t$.
\item \textbf{Number of Risky Traded Assets:} There is still {one} risky traded asset: $S_t$.
\end{enumerate}
The number of risky traded assets equals the number of independent sources of risk ($1=1$). The single risky asset $S_t$ is sufficient to hedge all systemic risk in the market, even for claims whose payoff $F(S_T, X_T)$ depends on the untraded index $X_t$. The market is therefore complete.
		
		\clearpage
		\section{Question 5}
		 Consider the simple Black-Scholes market:
		
		$$
		\begin{cases}d S_{t}=\mu S_{t} d t+\sigma S_{t} d W_{t}, & S_{0}=s_{0} \\ d B_{t}=r B_{t} d t, & B_{0}=1\end{cases}
		$$
		
		where $W=\left(W_{t}\right)_{t \geq 0}$ is a $\mathbb{P}$-Brownian motion. Fix a time step $\Delta t>0$, and let $\mu=0.25, r=0.05, \sigma=0.5$ and $s_{0}=10$. Let $K=10$ be the strike price for a European call option with payoff $\left(S_{T}-K\right)_{+}$at time $T=1$. Implement, using a programming language of your choice, a (discrete) deltahedging portfolio in the stock and the bank account for the call option. Denote by $P=\left(P_{t}\right)_{t \geq 0}$ the price of the call option and $H=\left(H_{t}\right)_{t \geq 0}$ the value of the hedging portfolio. 
		
		Create a histogram of the hedging error $P_{T}-H_{T}$ by running many simulations.
		
		
	\end{document}
